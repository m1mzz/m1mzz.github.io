(window["pickystoryJsonp"]=window["pickystoryJsonp"]||[]).push([["insertion"],{"0f32":function(e,t,n){var r=n("b047c"),i=n("1a8c"),o="Expected a function";function a(e,t,n){var a=!0,l=!0;if("function"!=typeof e)throw new TypeError(o);return i(n)&&(a="leading"in n?!!n.leading:a,l="trailing"in n?!!n.trailing:l),r(e,t,{leading:a,maxWait:t,trailing:l})}e.exports=a},4820:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(e){return function(t){return s([e,t])}}function s(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(l){o=[6,l],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},o=this&&this.__values||function(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var a,l,s,c=n("6ea9");function u(e,t){if(e.nodeType!==Node.ELEMENT_NODE)throw new Error("Can't generate CSS selector for non-element node type.");if("html"===e.tagName.toLowerCase())return"html";var n={root:document.body,idName:function(e){return!0},className:function(e){return!0},tagName:function(e){return!0},attr:function(e,t){return!1},seedMinLength:1,optimizedMinLength:2,threshold:1e3,maxNumberOfTries:1e4};l=r({},n,t),s=d(l.root,n);var i=h(e,a.All,(function(){return h(e,a.Two,(function(){return h(e,a.One)}))}));if(i){var o=O(P(i,e));return o.length>0&&(i=o[0]),g(i)}throw new Error("Selector was not found.")}function d(e,t){return e.nodeType===Node.DOCUMENT_NODE?e:e===t.root?e.ownerDocument:e}function h(e,t,n){var r=null,i=[],o=e,s=0,c=function(){var e=k(v(o))||k.apply(void 0,y(o))||k.apply(void 0,w(o))||k(b(o))||[S()],c=E(o);if(t===a.All)c&&(e=e.concat(e.filter(L).map((function(e){return x(e,c)}))));else if(t===a.Two)e=e.slice(0,1),c&&(e=e.concat(e.filter(L).map((function(e){return x(e,c)}))));else if(t===a.One){var u=(e=e.slice(0,1))[0];c&&L(u)&&(e=[x(u,c)])}for(var d=0,h=e;d<h.length;d++){u=h[d];u.level=s}if(i.push(e),i.length>=l.seedMinLength&&(r=f(i,n),r))return"break";o=o.parentElement,s++};while(o&&o!==l.root.parentElement){var u=c();if("break"===u)break}return r||(r=f(i,n)),r}function f(e,t){var n=O(T(e));if(n.length>l.threshold)return t?t():null;for(var r=0,i=n;r<i.length;r++){var o=i[r];if(m(o))return o}return null}function g(e){for(var t=e[0],n=t.name,r=1;r<e.length;r++){var i=e[r].level||0;n=t.level===i-1?e[r].name+" > "+n:e[r].name+" "+n,t=e[r]}return n}function p(e){return e.map((function(e){return e.penalty})).reduce((function(e,t){return e+t}),0)}function m(e){switch(s.querySelectorAll(g(e)).length){case 0:throw new Error("Can't select any node with this selector: "+g(e));case 1:return!0;default:return!1}}function v(e){var t=e.getAttribute("id");return t&&l.idName(t)?{name:"#"+c(t,{isIdentifier:!0}),penalty:0}:null}function y(e){var t=Array.from(e.attributes).filter((function(e){return l.attr(e.name,e.value)}));return t.map((function(e){return{name:"["+c(e.name,{isIdentifier:!0})+'="'+c(e.value)+'"]',penalty:.5}}))}function w(e){var t=Array.from(e.classList).filter(l.className);return t.map((function(e){return{name:"."+c(e,{isIdentifier:!0}),penalty:1}}))}function b(e){var t=e.tagName.toLowerCase();return l.tagName(t)?{name:t,penalty:2}:null}function S(){return{name:"*",penalty:3}}function E(e){var t=e.parentNode;if(!t)return null;var n=t.firstChild;if(!n)return null;var r=0;while(n){if(n.nodeType===Node.ELEMENT_NODE&&r++,n===e)break;n=n.nextSibling}return r}function x(e,t){return{name:e.name+":nth-child("+t+")",penalty:e.penalty+1}}function L(e){return"html"!==e.name&&!e.name.startsWith("#")}function k(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.filter(N);return n.length>0?n:null}function N(e){return null!==e&&void 0!==e}function T(e,t){var n,r,a;return void 0===t&&(t=[]),i(this,(function(i){switch(i.label){case 0:if(!(e.length>0))return[3,5];n=0,r=e[0],i.label=1;case 1:return n<r.length?(a=r[n],[5,o(T(e.slice(1,e.length),t.concat(a)))]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[3,7];case 5:return[4,t];case 6:i.sent(),i.label=7;case 7:return[2]}}))}function O(e){return Array.from(e).sort((function(e,t){return p(e)-p(t)}))}function P(e,t,n){var r,a,s;return void 0===n&&(n={counter:0,visited:new Map}),i(this,(function(i){switch(i.label){case 0:if(!(e.length>2&&e.length>l.optimizedMinLength))return[3,5];r=1,i.label=1;case 1:return r<e.length-1?n.counter>l.maxNumberOfTries?[2]:(n.counter+=1,a=e.slice(),a.splice(r,1),s=g(a),n.visited.has(s)?[2]:m(a)&&C(a,t)?[4,a]:[3,4]):[3,5];case 2:return i.sent(),n.visited.set(s,!0),[5,o(P(a,t,n))];case 3:i.sent(),i.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}function C(e,t){return s.querySelector(g(e))===t}(function(e){e[e["All"]=0]="All",e[e["Two"]=1]="Two",e[e["One"]=2]="One"})(a||(a={})),t.default=u},"6ea9":function(e,t,n){"use strict";
/*! https://mths.be/cssesc v1.0.1 by @mathias */var r={},i=r.hasOwnProperty,o=function(e,t){if(!e)return t;var n={};for(var r in t)n[r]=i.call(e,r)?e[r]:t[r];return n},a=/[ -,\.\/;-@\[-\^`\{-~]/,l=/[ -,\.\/;-@\[\]\^`\{-~]/,s=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,c=function e(t,n){n=o(n,e.options),"single"!=n.quotes&&"double"!=n.quotes&&(n.quotes="single");var r="double"==n.quotes?'"':"'",i=n.isIdentifier,c=t.charAt(0),u="",d=0,h=t.length;while(d<h){var f=t.charAt(d++),g=f.charCodeAt(),p=void 0;if(g<32||g>126){if(g>=55296&&g<=56319&&d<h){var m=t.charCodeAt(d++);56320==(64512&m)?g=((1023&g)<<10)+(1023&m)+65536:d--}p="\\"+g.toString(16).toUpperCase()+" "}else p=n.escapeEverything?a.test(f)?"\\"+f:"\\"+g.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B:]/.test(f)?i||":"!=f?"\\"+g.toString(16).toUpperCase()+" ":f:"\\"==f||!i&&('"'==f&&r==f||"'"==f&&r==f)||i&&l.test(f)?"\\"+f:f;u+=p}return i&&(/^_/.test(u)?u="\\_"+u.slice(1):/^-[-\d]/.test(u)?u="\\-"+u.slice(1):/\d/.test(c)&&(u="\\3"+c+" "+u.slice(1))),u=u.replace(s,(function(e,t,n){return t&&t.length%2?e:(t||"")+n})),!i&&n.wrap?r+u+r:u};c.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},c.version="1.0.1",e.exports=c},"9c42":function(e,t,n){"use strict";n("b692")},b692:function(e,t,n){var r=n("d002");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("499e").default;i("34a99d2e",r,!0,{sourceMap:!1,shadowMode:!1})},d002:function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,'.picky-widget{--picky-slide-height:510px}.picky-can-insert{margin:20px 0;height:20px;width:100%;background-color:#e4beff;position:relative;display:block!important}.picky-can-insert.warning{height:100%;width:100%;border-radius:4px;box-shadow:0 3px 6px rgba(0,0,0,.16);background-color:red}.picky-can-insert.warning:after{content:"Choose a wider container";padding:1rem;color:#fff}',""]),e.exports=t},f60e:function(e,t,n){"use strict";n.r(t);var r,i,o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},a=[],l=n("4820"),s=n.n(l),c=n("d790"),u=n("2f62"),d=n("2722"),h=n("dd61"),f=n.n(h),g=n("6cd4"),p=n.n(g),m=n("9380"),v=n.n(m),y=n("2769"),w=n.n(y),b=n("adaa"),S=n.n(b),E=n("3eda"),x=n.n(E),L=n("0f32"),k=n.n(L),N=n("f90f"),T={name:"WithPickyStyle",data(){return{isStyleLoaded:!1}},mounted(){this.isStyleLoaded||(this.isStyleLoaded=!0,this.loadFont())},methods:{loadFont(){const e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href="https://fonts.googleapis.com/css2?family=Lato&display=swap",document.head.appendChild(e)}}},O=T,P=n("2877"),C=Object(P["a"])(O,r,i,!1,null,null,null),A=C.exports,_={name:"InsertWidgetTool",data(){return{selector:null,preventPlace:null,currentElement:null,lastX:0,lastY:0}},mixins:[d["b"],A],computed:{...Object(u["b"])({widgetSettings:"getWidgetSettings",locations:"getLocations"}),...Object(u["b"])("insertWidgetTool",["campaignCategory","campaignSlug","widgetSlug","widgetPathName","designerCoordinates","updateWidgetSelector","waitReloadingList"]),currentLocation(){return w()(this.locations,{slug:this.campaignSlug})},isValidSelector(){return this.selector&&"html"!==this.selector&&"body"!==this.selector&&-1===this.selector.indexOf("picky")},isPlaceholderTooNarrow(){var e,t;return(null===(e=this.currentElement)||void 0===e||null===(t=e.parentElement)||void 0===t?void 0:t.clientWidth)<250},isNotPicky(){return!Object(N["c"])(this.currentElement)}},methods:{getDefaultLocations(){return[{slug:this.campaignSlug,widgets:[{slug:this.widgetSlug,insertionElementSelector:this.selector}]}]},updateElementSelector(){var e,t,n,r;const i=w()(null===(e=this.theme)||void 0===e||null===(t=e.namespaces)||void 0===t?void 0:t.locations,{slug:this.campaignSlug}),o=w()(null===i||void 0===i?void 0:i.widgets,{slug:this.widgetSlug}),a=o?f()(null===(n=this.theme)||void 0===n||null===(r=n.namespaces)||void 0===r?void 0:r.locations,e=>(null===e||void 0===e?void 0:e.slug)!==this.campaignSlug?e:{...e,widgets:f()(null===e||void 0===e?void 0:e.widgets,e=>(null===e||void 0===e?void 0:e.slug)!==this.widgetSlug?e:{...e,insertionElementSelector:this.selector})}):this.getDefaultLocations();this.$store.commit("SET_THEME",{...this.theme,namespaces:{locations:a}})},removeInsertedLocationWidgets(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];p()(null!==t&&void 0!==t?t:[],t=>{const n=document.querySelectorAll('[data-location-slug="'.concat(e,'"][data-widget-slug="').concat(t,'"]'));p()(n,e=>e.remove())})},removeInsertedWidget(){const e=document.querySelectorAll('\n        [data-widget-slug="'.concat(this.widgetSlug,'"],\n        [data-location-slug="').concat(this.campaignSlug,'"],\n        [data-location-category="').concat(this.campaignCategory,'"]\n      '));p()(e,e=>e.remove())},removeMessagePlace(){document.querySelectorAll(".picky-can-insert").forEach(e=>e.remove())},throttleCheckPlace:k()((function(e){this.checkPlace(e)}),100),checkPlace(e){let{x:t,y:n}=e;if(this.lastX===t&&this.lastY===n)return;this.lastX=t,this.lastY=n;const r=s()(document.elementFromPoint(t,n)),i=S()(()=>document.querySelector(r));if(!x()(i)&&i&&this.isNotPicky){this.currentElement=i,this.selector=r;const e=document.createElement("div");e.className="picky-can-insert",this.preventPlace!==this.currentElement&&(this.removeMessagePlace(),this.preventPlace=this.currentElement,this.isPlaceholderTooNarrow&&e.classList.add("warning"),this.currentElement.after(e),this.$store.commit("insertWidgetTool/".concat(c["b"]),this.selector))}}},watch:{designerCoordinates:{deep:!0,handler(e){let{x:t,y:n}=e;this.throttleCheckPlace({x:t,y:n})}},updateWidgetSelector(){this.removeInsertedWidget(),this.removeMessagePlace(),this.updateElementSelector(),this.renderLocation(this.currentLocation),this.$store.commit("insertWidgetTool/".concat(c["c"]),!1)},waitReloadingList(){var e,t;if(!this.waitReloadingList)return;const n=v()(null!==(e=null===(t=this.currentLocation)||void 0===t?void 0:t.widgets)&&void 0!==e?e:[],e=>w()(this.waitReloadingList,{slug:e.slug,type:e.type}));var r;n.length>0&&(this.removeInsertedLocationWidgets(null===(r=this.currentLocation)||void 0===r?void 0:r.slug,f()(n,e=>e.slug)),this.renderLocation({...this.currentLocation,widgets:n}));this.$store.commit("insertWidgetTool/".concat(c["d"]),!1)},widgetPathName(){this.renderLocations()}}},M=_,W=(n("9c42"),Object(P["a"])(M,o,a,!1,null,null,null));t["default"]=W.exports}}]);